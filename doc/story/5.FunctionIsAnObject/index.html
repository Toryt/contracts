<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>A Function is an Object</title>
  <link href="../../lib/prism/prism.css" rel="stylesheet"/>
  <link href="../story.css" rel="stylesheet"/>
</head>
<body>

<div class="navigate prev"><a href="../4.SeparateConditions/index.html">Previous</a></div>

<p>Quite trivial: instead of using global variables, that refer to the subject function by name
  (yuck), we can add the sets of conditions as properties of the function itself:
  <a href="#fibonacciContract.1-4">preconditions with property name <code class="language-javascript">pre</code></a>,
  <a href="#fibonacciContract.5-9">postconditions with property name <code class="language-javascript">post</code></a>.</p>

<pre id="fibonacciContract" class="line-numbers" data-src="../fibonacciContract.js" data-eval="script"
     data-line="1-4,5-9"></pre>

<p>It does ruffle my stylistic feathers a bit that we can only define the conditions after we have
  introduced the <a href="#code.23-44">main function</a> (they are represented in a different order in this
  text), but this kind of weird structure is not
  uncommon in JavaScript. Typically, you do some meta-programming around this …</p>

<pre id="code" class="line-numbers" data-src="code.js" data-eval="script"
     data-line="1-10,12-21,23-44"></pre>

<p><a href="#code.1-10"><code class="language-javascript">preconditions(conditions, n)</code></a>
  and <a href="#code.12-21"><code class="language-javascript">postconditions(conditions, n, result)</code></a>
  are now general in respect with the set of conditions they need to handle: the set to handle is now a
  parameter.</p>

<p>That parameter must still be supplied explicitly when calling the check-functions … explicitly …
  in the <a href="#code.23-44">main function</a>.</p>

<p>This is a true refactor. Nothing changes in the output of <code
    class="language-javascript">fibonacci(&quot;a&quot;)</code>:</p>

<div id="prism-eval-output-fibonacciWithA"></div>

<p>And nothing changes in the output of the of <code class="language-javascript">fibonacci</code>
  with the integers from -1 to 9:</p>

<div id="prism-eval-output-fibonacciWithI"></div>

<div class="navigate next"><a href="../6.OneVerify/index.html">Next</a></div>

<div id="prism-eval-output"></div> <!-- not used -->


<script src="../../lib/prism/prism.js"></script>
<script src="code.js"></script>
<script src="../fibonacciContract.js"></script>
<script src="../execFibonacci.js"></script>

</body>
</html>
